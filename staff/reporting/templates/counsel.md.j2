# Counsel of the Grey Pilgrim

> *"All that is gold does not glitter, not all those who wander are lost..."*

---

## Security Posture

{% if posture %}
| | |
|---|---|
| **Score** | **{{ posture.overall_score }}/100** (Grade: **{{ posture.grade }}**) |
| **Verdict** | *{{ posture.verdict }}* |

### Category Breakdown

| Category | Score | Weight | Assessment |
|----------|-------|--------|------------|
{% for cat in posture.categories %}
| {{ cat.name }} | {{ cat.score }}/100 | {{ (cat.weight * 100) | int }}% | {{ cat.summary }} |
{% endfor %}

{% for cat in posture.categories %}
{% if cat.details %}
<details>
<summary><strong>{{ cat.name }}</strong> â€” {{ cat.summary }}</summary>

{% for detail in cat.details %}
- {{ detail }}
{% endfor %}

</details>

{% endif %}
{% endfor %}
{% else %}
*Posture scoring unavailable â€” no scan data.*
{% endif %}

---

## Assessment Summary

| Attribute | Value |
|-----------|-------|
| **Target** | {{ session.target }} |
| **Timestamp** | {{ session.timestamp.strftime('%Y-%m-%d %H:%M:%S') }} |
| **Timing Mode** | {{ session.timing_mode | capitalize }} |
| **Total Findings** | {{ findings | length }} |

---

## Network Topology

{% if posture and posture.topology and posture.topology.hosts %}
*{{ posture.topology.host_count }} host(s) surveyed.*

| Host | Role | Hostname | Open Ports | Services |
|------|------|----------|------------|----------|
{% for h in posture.topology.hosts %}
| {{ h.icon }} {{ h.ip }} | {{ h.role }} | {{ h.hostname or 'â€”' }} | {{ h.open_ports }} | {% for s in h.services %}{{ s.service }}({{ s.port }}){% if not loop.last %}, {% endif %}{% endfor %} |
{% endfor %}

{% elif hosts %}
### Discovered Hosts

| IP Address | Hostname | Status | MAC Address |
|------------|----------|--------|-------------|
{% for host in hosts %}
| {{ host.ip_address }} | {{ host.hostname or '-' }} | {{ 'âœ“ Up' if host.status == 'up' else 'âœ— Down' }} | {{ host.mac_address or '-' }} |
{% endfor %}

**Total Hosts Discovered:** {{ hosts | length }}
{% else %}
*No hosts were discovered in this scan.*
{% endif %}

---

## Open Gates

*"There are many doors in this realm, and some should remain shut."*

{% if ports_by_host %}
{% for host, ports in ports_by_host.items() %}
### {{ host }}

| Port | Protocol | State | Service | Version |
|------|----------|-------|---------|---------|
{% for port in ports %}
| {{ port.port }} | {{ port.protocol | upper }} | {{ port.state | capitalize }} | {{ port.service or 'Unknown' }} | {{ port.product }}{% if port.version %} {{ port.version }}{% endif %} |
{% endfor %}

{% endfor %}
{% else %}
*No open ports were detected.*
{% endif %}

---

## Shadows and Flames

*The Grey Pilgrim has identified the following concerns...*

{% if findings %}
{% set critical_findings = findings | selectattr('severity', 'equalto', 'critical') | list %}
{% set warning_findings = findings | selectattr('severity', 'equalto', 'warning') | list %}
{% set info_findings = findings | selectattr('severity', 'equalto', 'info') | list %}

{% if critical_findings %}
### ðŸ”´ Critical Findings ({{ critical_findings | length }})

*"Fly, you fools!"*

{% for finding in critical_findings %}
#### {{ finding.title }}

- **Host:** {{ finding.host }}
{% if finding.port %}- **Port:** {{ finding.port }}{% endif %}

- **Description:** {{ finding.description }}
- **Recommendation:** {{ finding.recommendation }}

{% endfor %}
{% endif %}

{% if warning_findings %}
### ðŸŸ¡ Warning Findings ({{ warning_findings | length }})

*"I would not take this road without caution."*

{% for finding in warning_findings %}
#### {{ finding.title }}

- **Host:** {{ finding.host }}
{% if finding.port %}- **Port:** {{ finding.port }}{% endif %}

- **Description:** {{ finding.description }}
- **Recommendation:** {{ finding.recommendation }}

{% endfor %}
{% endif %}

{% if info_findings %}
### ðŸŸ¢ Informational ({{ info_findings | length }})

*"The Grey Pilgrim finds this acceptable, for now."*

{% for finding in info_findings %}
#### {{ finding.title }}

- **Host:** {{ finding.host }}
{% if finding.port %}- **Port:** {{ finding.port }}{% endif %}

- **Description:** {{ finding.description }}
- **Recommendation:** {{ finding.recommendation }}

{% endfor %}
{% endif %}

{% else %}
*No significant security findings were identified. The realm appears well-guarded.*
{% endif %}

---

